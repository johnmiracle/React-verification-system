{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/apple/Downloads/React-verification-system/client/src/pages/CropDemo.js\",\n    _s = $RefreshSig$();\n\n/** @format */\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\nimport ReactCrop from 'react-image-crop';\nimport 'react-image-crop/dist/ReactCrop.css';\nimport CropDialog from './CropDialog';\nconst PIXEL_RATIO = 4;\n\nfunction CropDemo(props) {\n  _s();\n\n  const [crop, setCrop] = useState({\n    unit: '%',\n    width: 80,\n    aspect: 16 / 9\n  });\n  const [src, setSrc] = useState();\n  const [completedCrop, setCompletedCrop] = useState();\n  const [open, setModalOpen] = useState(false);\n  const [preview, setPreview] = useState();\n  const [croppedFile, setCroppedFile] = useState();\n  const imgRef = useRef(null);\n  const previewCanvasRef = useRef(null);\n  const onLoad = useCallback(img => {\n    imgRef.current = img;\n  }, []);\n  useEffect(() => {\n    if (props.selectedFile) {\n      const reader = new FileReader();\n      reader.addEventListener('load', () => setSrc(reader.result));\n      reader.readAsDataURL(props.selectedFile);\n      setModalOpen(true);\n    }\n  }, [props.selectedFile]);\n  useEffect(() => {\n    if (!completedCrop || !previewCanvasRef.current || !imgRef.current) {\n      return;\n    }\n\n    const image = imgRef.current;\n    const canvas = previewCanvasRef.current;\n    const crop = completedCrop;\n    const scaleX = image.naturalWidth / image.width;\n    const scaleY = image.naturalHeight / image.height;\n    const ctx = canvas.getContext('2d');\n    canvas.width = crop.width * PIXEL_RATIO;\n    canvas.height = crop.height * PIXEL_RATIO;\n    ctx.setTransform(PIXEL_RATIO, 0, 0, PIXEL_RATIO, 0, 0);\n    ctx.imageSmoothingEnabled = false;\n    ctx.drawImage(image, crop.x * scaleX, crop.y * scaleY, crop.width * scaleX, crop.height * scaleY, 0, 0, crop.width, crop.height);\n    canvas.toBlob(blob => {\n      const previewUrl = URL.createObjectURL(blob);\n      const newFile = new File([blob], props.selectedFile.name);\n      setPreview(previewUrl);\n      setCroppedFile(newFile);\n    }, 'image/jpg');\n  }, [completedCrop]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(CropDialog, {\n      open: open,\n      onHide: () => setModalOpen(false),\n      onSave: () => {\n        props.onSave({\n          file: croppedFile,\n          preview\n        });\n        setModalOpen(false);\n      },\n      children: [/*#__PURE__*/_jsxDEV(ReactCrop, {\n        src: src,\n        style: {\n          maxHeight: '550px'\n        },\n        crop: crop,\n        locked: true,\n        onChange: (crop, percentCrop) => setCrop(percentCrop),\n        onComplete: c => setCompletedCrop(c),\n        onImageLoaded: onLoad,\n        className: \"btn btn-primary\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: previewCanvasRef,\n      style: {\n        width: 0,\n        height: 0\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true);\n}\n\n_s(CropDemo, \"9Uc1m64KaBPSWWJCCcNsskI19Pg=\");\n\n_c = CropDemo;\nexport default CropDemo;\n\nvar _c;\n\n$RefreshReg$(_c, \"CropDemo\");","map":{"version":3,"sources":["/Users/apple/Downloads/React-verification-system/client/src/pages/CropDemo.js"],"names":["React","useCallback","useEffect","useRef","useState","ReactCrop","CropDialog","PIXEL_RATIO","CropDemo","props","crop","setCrop","unit","width","aspect","src","setSrc","completedCrop","setCompletedCrop","open","setModalOpen","preview","setPreview","croppedFile","setCroppedFile","imgRef","previewCanvasRef","onLoad","img","current","selectedFile","reader","FileReader","addEventListener","result","readAsDataURL","image","canvas","scaleX","naturalWidth","scaleY","naturalHeight","height","ctx","getContext","setTransform","imageSmoothingEnabled","drawImage","x","y","toBlob","blob","previewUrl","URL","createObjectURL","newFile","File","name","onSave","file","maxHeight","percentCrop","c"],"mappings":"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","sourcesContent":["/** @format */\n\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\nimport ReactCrop from 'react-image-crop';\nimport 'react-image-crop/dist/ReactCrop.css';\nimport CropDialog from './CropDialog';\n\nconst PIXEL_RATIO = 4;\n\nfunction CropDemo(props) {\n\tconst [crop, setCrop] = useState({\n\t\tunit: '%',\n\t\twidth: 80,\n\t\taspect: 16 / 9\n\t});\n\n\tconst [src, setSrc] = useState();\n\n\tconst [completedCrop, setCompletedCrop] = useState();\n\n\tconst [open, setModalOpen] = useState(false);\n\n\tconst [preview, setPreview] = useState();\n\tconst [croppedFile, setCroppedFile] = useState();\n\n\tconst imgRef = useRef(null);\n\n\tconst previewCanvasRef = useRef(null);\n\n\tconst onLoad = useCallback((img) => {\n\t\timgRef.current = img;\n\t}, []);\n\n\tuseEffect(() => {\n\t\tif (props.selectedFile) {\n\t\t\tconst reader = new FileReader();\n\t\t\treader.addEventListener('load', () => setSrc(reader.result));\n\t\t\treader.readAsDataURL(props.selectedFile);\n\t\t\tsetModalOpen(true);\n\t\t}\n\t}, [props.selectedFile]);\n\n\tuseEffect(() => {\n\t\tif (!completedCrop || !previewCanvasRef.current || !imgRef.current) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst image = imgRef.current;\n\t\tconst canvas = previewCanvasRef.current;\n\t\tconst crop = completedCrop;\n\n\t\tconst scaleX = image.naturalWidth / image.width;\n\t\tconst scaleY = image.naturalHeight / image.height;\n\n\t\tconst ctx = canvas.getContext('2d');\n\n\t\tcanvas.width = crop.width * PIXEL_RATIO;\n\t\tcanvas.height = crop.height * PIXEL_RATIO;\n\n\t\tctx.setTransform(PIXEL_RATIO, 0, 0, PIXEL_RATIO, 0, 0);\n\t\tctx.imageSmoothingEnabled = false;\n\n\t\tctx.drawImage(\n\t\t\timage,\n\t\t\tcrop.x * scaleX,\n\t\t\tcrop.y * scaleY,\n\t\t\tcrop.width * scaleX,\n\t\t\tcrop.height * scaleY,\n\t\t\t0,\n\t\t\t0,\n\t\t\tcrop.width,\n\t\t\tcrop.height\n\t\t);\n\n\t\tcanvas.toBlob((blob) => {\n\t\t\tconst previewUrl = URL.createObjectURL(blob);\n\t\t\tconst newFile = new File([blob], props.selectedFile.name);\n\n\t\t\tsetPreview(previewUrl);\n\t\t\tsetCroppedFile(newFile);\n\t\t}, 'image/jpg');\n\t}, [completedCrop]);\n\n\treturn (\n\t\t<>\n\t\t\t<CropDialog\n\t\t\t\topen={open}\n\t\t\t\tonHide={() => setModalOpen(false)}\n\t\t\t\tonSave={() => {\n\t\t\t\t\tprops.onSave({ file: croppedFile, preview });\n\t\t\t\t\tsetModalOpen(false);\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<ReactCrop\n\t\t\t\t\tsrc={src}\n\t\t\t\t\tstyle={{ maxHeight: '550px' }}\n\t\t\t\t\tcrop={crop}\n\t\t\t\t\tlocked\n\t\t\t\t\tonChange={(crop, percentCrop) => setCrop(percentCrop)}\n\t\t\t\t\tonComplete={(c) => setCompletedCrop(c)}\n\t\t\t\t\tonImageLoaded={onLoad}\n\t\t\t\t\tclassName=\"btn btn-primary\"\n\t\t\t\t/>\n\t\t\t\t<input />\n\t\t\t</CropDialog>\n\n\t\t\t<canvas ref={previewCanvasRef} style={{ width: 0, height: 0 }} />\n\t\t</>\n\t);\n}\n\nexport default CropDemo;\n"]},"metadata":{},"sourceType":"module"}