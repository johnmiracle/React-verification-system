{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/apple/Downloads/React-verification-system/client/src/pages/CropDemo.js\",\n    _s = $RefreshSig$();\n\n/** @format */\nimport React, { useState } from 'react';\nimport ReactCrop from 'react-image-crop';\nimport 'react-image-crop/dist/ReactCrop.css';\nimport CropDialog from './CropDialog';\nconst PIXEL_RATIO = 4;\n\nfunction CropDemo(props) {\n  _s();\n\n  const [crop, setCrop] = React.useState({\n    unit: '%',\n    width: 80,\n    aspect: 16 / 9\n  });\n  const [src, setSrc] = React.useState();\n  const [completedCrop, setCompletedCrop] = React.useState();\n  const [open, setModalOpen] = React.useState(false);\n  const [preview, setPreview] = React.useState();\n  const [croppedFile, setCroppedFile] = React.useState();\n  const imgRef = React.useRef(null);\n  const previewCanvasRef = React.useRef(null);\n  const onLoad = React.useCallback(img => {\n    imgRef.current = img;\n  }, []);\n  React.useEffect(() => {\n    if (props.selectedFile) {\n      const reader = new FileReader();\n      reader.addEventListener('load', () => setSrc(reader.result));\n      reader.readAsDataURL(props.selectedFile);\n      setModalOpen(true);\n    }\n  }, [props.selectedFile]);\n  React.useEffect(() => {\n    if (!completedCrop || !previewCanvasRef.current || !imgRef.current) {\n      return;\n    }\n\n    const image = imgRef.current;\n    const canvas = previewCanvasRef.current;\n    const crop = completedCrop;\n    const scaleX = image.naturalWidth / image.width;\n    const scaleY = image.naturalHeight / image.height;\n    const ctx = canvas.getContext('2d');\n    canvas.width = crop.width * PIXEL_RATIO;\n    canvas.height = crop.height * PIXEL_RATIO;\n    ctx.setTransform(PIXEL_RATIO, 0, 0, PIXEL_RATIO, 0, 0);\n    ctx.imageSmoothingEnabled = false;\n    ctx.drawImage(image, crop.x * scaleX, crop.y * scaleY, crop.width * scaleX, crop.height * scaleY, 0, 0, crop.width, crop.height);\n    canvas.toBlob(blob => {\n      const previewUrl = URL.createObjectURL(blob);\n      const newFile = new File([blob], props.selectedFile.name);\n      setPreview(previewUrl);\n      setCroppedFile(newFile);\n    }, 'image/jpg');\n  }, [completedCrop]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(CropDialog, {\n      open: open,\n      onHide: () => setModalOpen(false),\n      onSave: () => {\n        props.onSave({\n          file: croppedFile,\n          preview\n        });\n        setModalOpen(false);\n      },\n      children: /*#__PURE__*/_jsxDEV(ReactCrop, {\n        src: src,\n        style: {\n          maxHeight: '550px'\n        },\n        crop: crop,\n        locked: true,\n        onChange: (crop, percentCrop) => setCrop(percentCrop),\n        onComplete: c => setCompletedCrop(c),\n        onImageLoaded: onLoad\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: previewCanvasRef,\n      style: {\n        width: 0,\n        height: 0\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true);\n}\n\n_s(CropDemo, \"9Uc1m64KaBPSWWJCCcNsskI19Pg=\");\n\n_c = CropDemo;\nexport default CropDemo;\n\nvar _c;\n\n$RefreshReg$(_c, \"CropDemo\");","map":{"version":3,"sources":["/Users/apple/Downloads/React-verification-system/client/src/pages/CropDemo.js"],"names":["React","useState","ReactCrop","CropDialog","PIXEL_RATIO","CropDemo","props","crop","setCrop","unit","width","aspect","src","setSrc","completedCrop","setCompletedCrop","open","setModalOpen","preview","setPreview","croppedFile","setCroppedFile","imgRef","useRef","previewCanvasRef","onLoad","useCallback","img","current","useEffect","selectedFile","reader","FileReader","addEventListener","result","readAsDataURL","image","canvas","scaleX","naturalWidth","scaleY","naturalHeight","height","ctx","getContext","setTransform","imageSmoothingEnabled","drawImage","x","y","toBlob","blob","previewUrl","URL","createObjectURL","newFile","File","name","onSave","file","maxHeight","percentCrop","c"],"mappings":"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","sourcesContent":["/** @format */\n\nimport React, { useState } from 'react';\nimport ReactCrop from 'react-image-crop';\nimport 'react-image-crop/dist/ReactCrop.css';\nimport CropDialog from './CropDialog';\n\nconst PIXEL_RATIO = 4;\n\nfunction CropDemo(props) {\n\tconst [crop, setCrop] = React.useState({\n\t\tunit: '%',\n\t\twidth: 80,\n\t\taspect: 16 / 9\n\t});\n\n\tconst [src, setSrc] = React.useState();\n\n\tconst [completedCrop, setCompletedCrop] = React.useState();\n\n\tconst [open, setModalOpen] = React.useState(false);\n\n\tconst [preview, setPreview] = React.useState();\n\tconst [croppedFile, setCroppedFile] = React.useState();\n\n\tconst imgRef = React.useRef(null);\n\n\tconst previewCanvasRef = React.useRef(null);\n\n\tconst onLoad = React.useCallback((img) => {\n\t\timgRef.current = img;\n\t}, []);\n\n\tReact.useEffect(() => {\n\t\tif (props.selectedFile) {\n\t\t\tconst reader = new FileReader();\n\t\t\treader.addEventListener('load', () => setSrc(reader.result));\n\t\t\treader.readAsDataURL(props.selectedFile);\n\t\t\tsetModalOpen(true);\n\t\t}\n\t}, [props.selectedFile]);\n\n\tReact.useEffect(() => {\n\t\tif (!completedCrop || !previewCanvasRef.current || !imgRef.current) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst image = imgRef.current;\n\t\tconst canvas = previewCanvasRef.current;\n\t\tconst crop = completedCrop;\n\n\t\tconst scaleX = image.naturalWidth / image.width;\n\t\tconst scaleY = image.naturalHeight / image.height;\n\n\t\tconst ctx = canvas.getContext('2d');\n\n\t\tcanvas.width = crop.width * PIXEL_RATIO;\n\t\tcanvas.height = crop.height * PIXEL_RATIO;\n\n\t\tctx.setTransform(PIXEL_RATIO, 0, 0, PIXEL_RATIO, 0, 0);\n\t\tctx.imageSmoothingEnabled = false;\n\n\t\tctx.drawImage(\n\t\t\timage,\n\t\t\tcrop.x * scaleX,\n\t\t\tcrop.y * scaleY,\n\t\t\tcrop.width * scaleX,\n\t\t\tcrop.height * scaleY,\n\t\t\t0,\n\t\t\t0,\n\t\t\tcrop.width,\n\t\t\tcrop.height\n\t\t);\n\n\t\tcanvas.toBlob((blob) => {\n\t\t\tconst previewUrl = URL.createObjectURL(blob);\n\t\t\tconst newFile = new File([blob], props.selectedFile.name);\n\n\t\t\tsetPreview(previewUrl);\n\t\t\tsetCroppedFile(newFile);\n\t\t}, 'image/jpg');\n\t}, [completedCrop]);\n\n\treturn (\n\t\t<>\n\t\t\t<CropDialog\n\t\t\t\topen={open}\n\t\t\t\tonHide={() => setModalOpen(false)}\n\t\t\t\tonSave={() => {\n\t\t\t\t\tprops.onSave({ file: croppedFile, preview });\n\t\t\t\t\tsetModalOpen(false);\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<ReactCrop\n\t\t\t\t\tsrc={src}\n\t\t\t\t\tstyle={{ maxHeight: '550px' }}\n\t\t\t\t\tcrop={crop}\n\t\t\t\t\tlocked\n\t\t\t\t\tonChange={(crop, percentCrop) => setCrop(percentCrop)}\n\t\t\t\t\tonComplete={(c) => setCompletedCrop(c)}\n\t\t\t\t\tonImageLoaded={onLoad}\n\t\t\t\t/>\n\t\t\t</CropDialog>\n\n\t\t\t<canvas ref={previewCanvasRef} style={{ width: 0, height: 0 }} />\n\t\t</>\n\t);\n}\n\nexport default CropDemo;\n"]},"metadata":{},"sourceType":"module"}